// 2. 圖層設定
// 台灣通用版電子地圖 (NLSC)
const nlscMap = L.tileLayer('https://wmts.nlsc.gov.tw/wmts/EMAP/default/GoogleMapsCompatible/{z}/{y}/{x}', {
    maxZoom: 18,
    attribution: '台灣通用版電子地圖'
});

// OSM 標準地圖
const osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '© OpenStreetMap'
});

// 【重點修正】穩定版魯地圖 HTTPS 鏡像
const rudyActual = L.tileLayer('https://tiles.happyman.idv.tw/map/rudy/{z}/{x}/{y}.png', {
    maxZoom: 18,
    attribution: '魯地圖 (Rudy Map) | Tiles by Happyman',
    opacity: 1.0,
    zIndex: 10 // 確保魯地圖層級在上方
});

// 預設載入魯地圖與 OSM (OSM 當底，魯地圖疊加或切換)
rudyActual.addTo(map);

// 更新控制選單
const baseMaps = {
    "魯地圖 (等高線)": rudyActual,
    "通用電子地圖": nlscMap,
    "OSM 街道圖": osm
};

L.control.layers(baseMaps).addTo(map);
